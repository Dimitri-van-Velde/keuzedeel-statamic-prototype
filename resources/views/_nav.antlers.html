<nav class="py-10 mx-auto max-w-7xl" x-data="{ showSearch: false, searchQuery: '', searchResults: false }">
    <div class="flex flex-wrap items-center justify-between lg:justify-start">
    <div class="antialiased font-medium text-md">
        <a href="/" class="block mr-12 font-black text-md md:text-lg lg:inline-block">{{ settings:site_name }}</a>
    </div>
    <div class="block lg:hidden">
        <button class="flex items-center px-3 text-gray-400" x-bind:class="{'hidden': showMobileNav}"
            @click="showMobileNav = true">
            <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <title>Open Menu</title>
                <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
            </svg>
        </button>
        <button class="items-center px-3 text-gray-400"
            x-bind:class="{'flex': showMobileNav, 'hidden': ! showMobileNav}" @click="showMobileNav = false" x-cloak>
            <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <title>Close Menu</title>
                <path
                    d="M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z" />
            </svg>
        </button>
    </div>
    <div class="items-center w-full lg:ml-auto lg:w-auto lg:flex" @click.outside="showMobileNav = false" x-show="showMobileNav">
        {{ nav }}
            <a href="{{ url }}"
                class="block {{ is_current || is_parent ?= 'font-medium text-white' }} mt-4 lg:inline-block text-gray-400 hover:text-white lg:mt-0 mr-12">
                {{ title }}
            </a>
        {{ /nav }}
        <button type="button" class="flex items-center mt-4 antialiased font-bold text-gray-500 transition lg:mt-0 lg:ml-auto group hover:text-white" @click="showSearch = true; $focus.next()">
            <svg class="mr-3 text-gray-500 transition group-hover:text-white" xmlns="http://www.w3.org/2000/svg" height="21" width="21" viewBox="0 0 16 16"><path d="M15.587 14.413l-4.354-4.353A6.1 6.1 0 0012.5 6.333a6.18 6.18 0 10-2.44 4.907l4.353 4.353a.84.84 0 001.174 0 .833.833 0 000-1.18zM1.833 6.333a4.5 4.5 0 114.5 4.5 4.507 4.507 0 01-4.5-4.5z" fill="currentColor"/></svg>
            <span>Search</span>
        </button>
    </div>
    </div>
    <div class="ml-auto" @keydown.escape="showSearch = (searchQuery !== ''); searchQuery = ''">
        <div
            class="fixed p-[12vh] inset-0 z-30 backdrop-blur-sm overflow-auto bg-black bg-opacity-50"
            x-cloak
            x-transition.opacity
            x-show="showSearch"
            x-trap.noscroll="showSearch"
        >
            <div class="w-full max-w-3xl mx-auto text-left bg-gray-200 rounded-lg" click.away="showSearch = false" x-transition @click.outside="showSearch = false; searchQuery = ''">
                <form action="search" class="flex items-center p-2 px-6">
                    <svg class="mr-4 text-gray-600" xmlns="http://www.w3.org/2000/svg" height="21" width="21" viewBox="0 0 16 16"><path d="M15.587 14.413l-4.354-4.353A6.1 6.1 0 0012.5 6.333a6.18 6.18 0 10-2.44 4.907l4.353 4.353a.84.84 0 001.174 0 .833.833 0 000-1.18zM1.833 6.333a4.5 4.5 0 114.5 4.5 4.507 4.507 0 01-4.5-4.5z" fill="currentColor"/></svg>
                    <input name="q" type="text" ref="searchInput" x-model="searchQuery" class="block inline-block w-full py-2 text-gray-600 bg-transparent focus:outline-none focus-border focus-border-gray-600" placeholder="...">
                    <button class="px-1 py-px tracking-wider text-red-500 text-2xs hover:text-red-700" @click="showSearch = false" type="button">
                        <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <title>Close Search</title>
                            <path
                                d="M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z" />
                        </svg>
                    </button>
                </form>
            </div>
        </div>
    </div>
</nav>
